#include utils/getActionList.jsx#include utils/helpers.jsxvar updateDropDownList = function updateDropDownList(list, newItems) {  list.removeAll();  for (var i = 0; i < newItems.length; i++) {    list.add('item', newItems[i]);  }};var dialogBox = function dialogBox() {  var selectActionDlg = new Window('dialog', 'Выбор экшена');  selectActionDlg.alignChildren = "left";  var actionGroup = selectActionDlg.add('group');  var actionList = getActionList();  var actionSets = getObjectKeys(actionList);  var actionSetSelector = actionGroup.add('dropdownlist', undefined, actionSets);  actionSetSelector.selection = 0;  var actionsOfSet = actionList[actionSetSelector.selection.text];  var actionSelector = actionGroup.add('dropdownlist', undefined, actionsOfSet);  var shouldSaveAndCloseDocument = selectActionDlg.add('checkbox', undefined, "Сохранить и закрыть документ после выполнения?");  var dlgControls = selectActionDlg.add('group');  var btnOk = dlgControls.add("button", undefined, "OK");  var btnCancel = dlgControls.add("button", undefined, "Cancel");  actionSelector.selection = 0;  actionSetSelector.onChange = function () {    updateDropDownList(actionSelector, actionList[this.selection.text]);    actionSelector.selection = 0;  };  btnOk.onClick = function () {    var options = {      action: actionSelector.selection.text,      actionSet: actionSetSelector.selection.text,      shouldSaveAndCloseDocument: shouldSaveAndCloseDocument.value,    };    runScript(options);    selectActionDlg.close();  };  selectActionDlg.show();};var applyAction = function applyAction(actionName, actionSetName) {  return function(doc) {    doc.activate();    app.doScript(actionName, actionSetName);  }};var runScript = function runScript(options) {  var docs = app.documents;  var actionName = options.action;  var actionSetName = options.actionSet;  var shouldSaveAndCloseDocument = options.shouldSaveAndCloseDocument;  var applyActionToDoc = applyAction(actionName, actionSetName);  for (var i = 0; i < docs.length; i++) {    applyActionToDoc(docs[i]);    if (shouldSaveAndCloseDocument) {      docs[i].save();      docs[i].close();    }  }};dialogBox();